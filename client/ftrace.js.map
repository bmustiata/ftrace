{"version":3,"sources":["../src/client/wrap-before.js","../src/once-many.js","../src/debug.js","../src/trace.js","../src/client/wrap-after.js"],"names":[],"mappings":"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","file":"ftrace.js","sourcesContent":["(function() {\n\n","var onceMany = function(once, many) {\n    var firstGenerated = false;\n\n    return {\n        next : function() {\n            if (firstGenerated) {\n                if (typeof many === \"function\") {\n                    return many.apply(this, arguments);\n                } else {\n                    return many;\n                }\n            } else {\n                firstGenerated = true;\n                if (typeof once === \"function\") {\n                    return once.apply(this, arguments);\n                } else {\n                    return once;\n                }\n            }\n        }\n    }\n};\n\n","var objectToString = function(item) {\n    if (typeof item == \"undefined\") {\n        return \"undefined\";\n    }\n\n    if (item == null) {\n        return \"null\";\n    }\n\n    if (typeof item == \"number\") {\n        return item;\n    }\n\n    if (typeof item == \"boolean\") {\n        return item;\n    }\n\n    if ((typeof item == \"object\" && item.call && item.apply) ||\n        (typeof item == \"function\")) {\n        return \"function()\";\n    }\n\n    if (typeof item == \"string\") {\n        return stringValue(item);\n    }\n\n    return \"[object]\";\n};\n\nvar stringValue = function(item) {\n    return '\"' + item.replace(/\"/g, \"\\\\\\\"\")\n        .replace(/\\n/g, \"\\\\n\") + '\"';\n};\n\n","var level = 0,\n    runningTraces = [ [] ],\n    outputConsole; // set the output console where the stack trace logs its stuff.\n\n// FIXME: made the level object specific, so multiple traces can run independently - threads?\n// FIXME: make the logging configurable somehow.\n\n/**\n * SingleStackItem - A single stack parsed item.\n * @param {} functionName\n * @param {} location\n * @return {void}\n */\nfunction SingleStackItem(functionName, location) {\n    this.functionName = functionName;\n    this.location = location;\n}\n\n/**\n * Parse the given stack items.\n * @param {string} stackString The stack string.\n * @return {Array<string>}\n */\nfunction parseStackItems(stackString) {\n    if (!/^Error/.test(stackString)) {\n        return []; // not a stack string\n    }\n\n    var result = [];\n    var stackItems = stackString.split(/\\n/);\n    var i;\n\n    for (i = stackItems.length - 1; i >= 1; i--)  {\n        result.push( parseSingleStackItem( stackItems[i] ) );\n    }\n\n    return result;\n}\n\n/**\n * parseSingleStackItem - Parses a single stack item.\n * @param {string} stackItem\n * @return {SingleStackItem}\n */\nfunction parseSingleStackItem(stackItem) {\n    var parsedItem = /^\\s*at\\s+((.*\\.)?(.*))\\s*\\((.*\\:\\d+:\\d+)\\)/.exec(stackItem)\n\n    if (parsedItem) {\n        return new SingleStackItem( parsedItem[3], parsedItem[4] );\n    }\n\n    parsedItem = /^\\s*at\\s+(.*\\:\\d+\\:\\d+$)/.exec(stackItem);\n\n    if (parsedItem) {\n        return new SingleStackItem( '<anonymous>', parsedItem[1] );\n    }\n\n    outputConsole.log(\"Unable to parse: `\" + stackItem + \"`\");\n\n    return null;\n}\n\nvar ftrace = {\n    /**\n     * Wrap a function using an enter/leave log.\n     */\n    wrap : function(name, location, func) {\n        return function() {\n            try {\n                ftrace.enter(name, location, arguments);\n                return func.apply(this, arguments);\n            } finally {\n                ftrace.leave(name);\n            }\n        }\n    },\n\n    /**\n     * Wraps the function call, and instead of tracing everything it uses\n     * the stack trace to solve previous calls.\n     */\n    ewrap : function(name, location, func) {\n        return function CiplogicFTraceWrapper() {\n            var stackItems,\n                currentCallCount,\n                i;\n\n            try {\n                var stackString;\n                try { throw new Error() } catch (e) { stackString = e.stack; } // fill the stack string\n\n                stackItems = parseStackItems(stackString);\n                currentCallCount = runningTraces[ runningTraces.length - 1 ].length;\n\n                for (i = currentCallCount; i < stackItems.length; i++) {\n                    if (/CiplogicFTraceWrapper/.test(stackItems[i].functionName)) {\n                        continue;\n                    }\n\n                    ftrace.enter(stackItems[i].functionName, stackItems[i].location, []);\n                }\n\n                // since the wrapped method is not yet called, we need to report it called.\n                ftrace.enter(name, location, arguments);\n\n                runningTraces.push( stackItems );\n\n                return func.apply(this, arguments);\n            } finally {\n                // report leaving the wrapped function\n                ftrace.leave(name);\n\n                for (i = stackItems.length - 1; i >= currentCallCount; i--) {\n                    if (/CiplogicFTraceWrapper/.test(stackItems[i].functionName)) {\n                        continue;\n                    }\n\n                    ftrace.leave(stackItems[i].functionName);\n                }\n\n                runningTraces.pop();\n            }\n        }\n    },\n\n    enter : function(name, location, args) {\n        var stringArgs = \"\",\n            comma = onceMany(\"\", \", \");\n\n        for (var i = 0; i < args.length; i++) {\n            stringArgs += comma.next() + objectToString(args[i]);\n        }\n\n        outputConsole.log(this._padding(level++) + \"=> \" + name + \"(\" + stringArgs +  \") : \" + location);\n    },\n\n    leave : function(name) {\n        outputConsole.log(this._padding(--level) + \"<= \" + name);\n    },\n\n    /**\n     * @param {object} outputConsole The output console for ftrace.\n     * @param {Function} outputConsole.log The log function that will be used.\n     */\n    setConsole : function(outputConsoleParam) {\n        outputConsole = outputConsoleParam;\n    },\n\n    /**\n     * Returns spaces padding by level, up to a lavel of 2.\n     */\n    _padding : function(l) {\n        var i,\n            result = \"\";\n\n        for (i = 0; i < l; i++) {\n            result = result + \"  \";\n        }\n\n        return result;\n    }\n};\n\n","window.ftrace = ftrace; // export the ftrace into the window context.\n\nftrace.setConsole( window.console || {\n    log : function() {\n        if (window.console) { // in IE8 the window.console apperas only when the console it's open\n            window.console.log.apply(window.console.log, arguments);\n        }\n    }\n});\n\n})();\n"]}